==================== MOON ====================                                                                                                               
Experiment Arguments:                                                                                                                                        
{                                                                                                                                                            
    'model': 'lenet5',                                                                                                                                       
    'dataset': 'cifar10',                                                                                                                                    
    'seed': 42,                                                                                                                                              
    'join_ratio': 0.1,                                                                                                                                       
    'global_epoch': 100,                                                                                                                                     
    'local_epoch': 5,                                                                                                                                        
    'finetune_epoch': 0,                                                                                                                                     
    'test_gap': 100,                                                                                                                                         
    'eval_test': 1,                                                                                                                                          
    'eval_val': 0,                                                                                                                                           
    'eval_train': 0,                                                                                                                                         
    'optimizer': 'sgd',                                                                                                                                      
    'local_lr': 0.01,                                                                                                                                        
    'momentum': 0.0,                                                                                                                                         
    'weight_decay': 0.0,                                                                                                                                     
    'verbose_gap': 10,                                                                                                                                       
    'batch_size': 32,                                                                                                                                        
    'visible': 0,                                                                                                                                            
    'straggler_ratio': 0,                                                                                                                                    
    'straggler_min_local_epoch': 1,                                                                                                                          
    'external_model_params_file': '',                                                                                                                        
    'use_cuda': 1,                                                                                                                                           
    'save_log': 1,                                                                                                                                           
    'save_model': 0,                                                                                                                                         
    'save_fig': 1,                                                                                                                                           
    'save_metrics': 1,                                                                                                                                       
    'viz_win_name': None,                                                                                                                                    
    'config_file': '',                                                                                                                                       
    'check_convergence': 1,                                                                                                                                  
    'tau': 0.5,                                                                                                                                              
    'mu': 5,                                                                                                                                                 
    'dataset_args': {                                                                                                                                        
        'dataset': 'cifar10',                                                                                                                                
        'client_num': 25,                                                                                                                                    
        'test_ratio': 0.25,                                                                                                                                  
        'val_ratio': 0.0,                                                                                                                                    
        'seed': 42,                                                                                                                                          
        'split': 'sample',                                                                                                                                   
        'alpha': 0.1,                                                                                                                                        
        'least_samples': 40                                                                                                                                  
    }                                                                                                                                                        
}                                                                                                                                                            
-------------------------- TRAINING EPOCH: 10 --------------------------                                                                                     
client [2] (test)  loss: 5.7153 -> 1.1056   accuracy: 6.73% -> 53.85%                                                                                        
client [6] (test)  loss: 263.3078 -> 1.2093   accuracy: 1.58% -> 53.02%                                                                                      
-------------------------- TRAINING EPOCH: 20 --------------------------                                                                                     
client [22] (test)  loss: 4.1493 -> 0.2684   accuracy: 1.88% -> 95.11%                                                                                       
client [13] (test)  loss: 2.5815 -> 0.3237   accuracy: 13.95% -> 90.86%                                                                                      
-------------------------- TRAINING EPOCH: 30 --------------------------                                                                                     
client [12] (test)  loss: 6.7801 -> 2.4428   accuracy: 15.24% -> 32.19%                                                                                      
client [2] (test)  loss: 5.5957 -> 0.8563   accuracy: 0.00% -> 62.50%                                                                                        
-------------------------- TRAINING EPOCH: 40 --------------------------                                                                                     
client [8] (test)  loss: 3.8052 -> 0.7403   accuracy: 31.77% -> 74.77%                                                                                       
client [14] (test)  loss: 2.8459 -> 0.3846   accuracy: 9.62% -> 87.40%                                                                                       
-------------------------- TRAINING EPOCH: 50 --------------------------                                                                                     
client [5] (test)  loss: 2.4570 -> 0.1947   accuracy: 12.59% -> 95.64%                                                                                       
client [14] (test)  loss: 2.7155 -> 0.3414   accuracy: 22.89% -> 89.55%                                                                                      
-------------------------- TRAINING EPOCH: 60 --------------------------                                                                                     
client [22] (test)  loss: 4.7404 -> 0.2261   accuracy: 0.00% -> 94.74%                                                                                       
client [10] (test)  loss: 4.9765 -> 1.9229   accuracy: 10.61% -> 54.55%                                                                                      
-------------------------- TRAINING EPOCH: 70 --------------------------                                                                                     
client [12] (test)  loss: 6.8918 -> 0.3849   accuracy: 12.22% -> 88.70%                                                                                      
client [11] (test)  loss: 6.2479 -> 0.7840   accuracy: 8.92% -> 72.77%                                                                                       
-------------------------- TRAINING EPOCH: 80 --------------------------                                                                                     
client [14] (test)  loss: 3.1893 -> 0.3414   accuracy: 30.85% -> 88.72%                                                                                      
client [16] (test)  loss: 2.2033 -> 0.2032   accuracy: 34.69% -> 92.84%                                                                                      
-------------------------- TRAINING EPOCH: 90 --------------------------                                                                                     
client [0] (test)  loss: 2.5870 -> 0.8163   accuracy: 35.84% -> 72.08%                                                                                       
client [23] (test)  loss: 5.0196 -> 0.2780   accuracy: 1.36% -> 91.56%                                                                                       
-------------------------- TRAINING EPOCH: 100 --------------------------                                                                                    
client [24] (test)  loss: 4.7178 -> 0.0622   accuracy: 1.07% -> 98.93%                                                                                       
client [16] (test)  loss: 4.2315 -> 0.1715   accuracy: 22.84% -> 94.44%                                                                                      
MOON's average time taken by each global epoch: 0 m 41.95 s.                                                                                                 
MOON's total running time: 1 h 10 m 10 s.                                                                                                                    
==================== MOON Experiment Results: ====================                                                                                           
Format: (before local fine-tuning) -> (after local fine-tuning)                                                                                              
{                                                                                                                                                            
    100: {                                                                                                                                                   
        'all_clients': {                                                                                                                                     
            'train': {'loss': '0.0000 -> 0.0000', 'accuracy': '0.00% -> 0.00%'},                                                                             
            'val': {'loss': '0.0000 -> 0.0000', 'accuracy': '0.00% -> 0.00%'},                                                                               
            'test': {'loss': '4.4698 -> 0.0000', 'accuracy': '20.04% -> 0.00%'}                                                                              
        }                                                                                                                                                    
    }                                                                                                                                                        
}                                                                                                                                                            
========== MOON Convergence on train clients ==========                                                                                                      
train (before local training):                                                                                                                               
val (before local training):                                                                                                                                 
test (before local training):                                                                                                                                
10.0%(10.74%) at epoch: 1                                                                                                                                    
50.0%(52.71%) at epoch: 3                                                                                                                                    
60.0%(63.40%) at epoch: 16                                                                                                                                   
70.0%(72.29%) at epoch: 28                                                                                                                                   
80.0%(85.92%) at epoch: 30                                                                                                                                   
train (after local training):                                                                                                                                
val (after local training):                                                                                                                                  
test (after local training):                                                                                                                                 
90.0%(92.28%) at epoch: 0                                                                                                                                    
==================== MOON Max Accuracy ====================                                                                                                  
all_clients:                                                                                                                                                 
(train) before fine-tuning: 0.00% at epoch 100                                                                                                               
(val) before fine-tuning: 0.00% at epoch 100                                                                                                                 
(test) before fine-tuning: 20.04% at epoch 100                                                                                                               
(train) after fine-tuning: 0.00% at epoch 100                                                                                                                
(val) after fine-tuning: 0.00% at epoch 100                                                                                                                  
(test) after fine-tuning: 0.00% at epoch 100                                                                                                                 
